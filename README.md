# Vulnerability-Scanning-Homelab-with-Nessus

## Summary
This repository demonstrates setting up a home lab environment and executing vulnerability scanning on a vulnerable virtual machine. This project was created by using Nessus documentation found in the [Tenable documentation page](https://docs.tenable.com/nessus/Content/CredentialedChecksOnWindows.htm#Configure-a-Local-Account) and other free tools linked below.

## Walkthrough

### Preparation:
1. Download VMware Workstation 17 for Windows.
    - [VMWare Workstation download](https://www.vmware.com/products/workstation-player/workstation-player-evaluation.html)
    
    ![Vulnerability scanning1](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/b56fb18e-aec5-4dfc-8444-88d79cf9a485)

2. Download the Windows 10 ISO file.
    - [Windows 10 ISO download](https://www.microsoft.com/en-us/software-download/windows10)
    
    ![Vulnerability scanning2](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/1e36b231-f2b8-4e7e-b4f1-aef59b21110b)

3. Download and install Nessus on the host machine.
    - [Nessus download](https://www.tenable.com/products/nessus/nessus-essentials)
    
    ![Vulnerability scanning3](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/71513a08-0623-4752-8010-6bc00bf10429)

### Create Virtual Machine (VM):
1. Run the Windows.exe file and select ISO file option, then save it to the PC.
2. Use VMware Workstation to create a new VM using the Windows ISO.
    - Allocate 4096 MB RAM, 4 processors, and a bridged network connection to the VM. (less can work - this is what I used.)
    
    ![Vulnerability scanning4](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/a29297c7-6241-4971-a89e-2eb61de8d709)

3. Finish installing Windows on the VM.

   ![Vulnerability scanning5](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/d282dadd-93f9-4cbf-93ae-62879acf7920)

### Check VM network connection response 
1. From your VM CLI, type ipconfig and identify the IPv4 address. (left CLI in picture below)
2. From your desktop CLI, type ping *IPv4 address of VM* (right CLI in picture below)

   ![Vulnerability scanning6](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/6df55e6d-ef14-40c1-bc4f-bed6e71fe565)


### Configure Nessus:
1. Launch Nessus, sign in, and create a basic scan by entering the IP address.
2. In Discovery settings, change to all ports and save the scan.

   ![Vulnerability scanning7](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/9e6c28ac-5bef-4b5b-ac25-edaaa247a68e)

### Run Initial Scan:
1. Launch the scan and wait for it to finish, observing results as they appear.
2. Review the initial scan results.

   ![Vulnerability scanning8](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/995b2ae9-b5d2-4a55-b3fd-6468530b5322)

### Prepare VM for Credentialed Scan:
1. Open services.msc on the VM and enable the Remote Registry service by changing the startup type to automatic.

   ![Vulnerability scanning9](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/bff91668-6735-4ce2-b9f6-8ee2211588cf)

2. In Registry Editor, navigate to HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System and create a DWORD value called **LocalAccountTokenFilterPolicy.**
   - Set its value to 1, and reset the VM.

    ![Vulnerability scanning10](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/1021c324-757a-4cd6-ac9c-c85949d76487)

3. Download and install a very old and outdated version of Firefox.

    - [Firefox Version 3.6.12 download](https://ftp.mozilla.org/pub/firefox/releases/3.6.12/win32/en-US/)
    
    ![Vulnerability scanning15](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/a5286a45-9b03-453c-9026-33f1cd189bce)


### Run Credentialed Scan:
1. Add VM credentials to the existing Nessus scan and save the settings.

   ![Vulnerability scanning11](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/563cc568-efd0-4507-9d53-ae4bce8ea7bd)

2. Run the scan, this time including credentialed checks.

   ![Vulnerability scanning16](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/9640f034-189a-474c-861b-8c6fe5ac25d8)


### Review Scan Results:
1. Analyze the results of the credentialed scan.

   ![Vulnerability scanning17](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/ca035217-dd6b-45b7-b281-8466e0c98f75)

2. Check the Recommendations tab in Nessus for remediation actions.

    ![Vulnerability scanning18](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/49b21e45-8ca4-45e7-998c-a810cf58330c)

### Perform Remediation:
1. Follow the recommended steps to remediate all critical vulnerabilities, such as uninstalling outdated software and applying Windows updates.
2. Run updates on the VM until it's fully up to date, including third-party software.
     - in this case, Firefox, Internet explorer, snipping tool and microsoft office 365 all need to be updated, exempted, exceptions made or uninstalled.
  
   ![Vulnerability scanning19](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/d2b8f42e-770c-48af-9d5f-dfdeecff00d4)

   ![Vulnerability scanning22](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/c9d39490-5051-4547-840c-1a071f3ff409)

### Final Scan and Review:
1. Run additional scans as needed to ensure all critical vulnerabilities have been remediated.
    - The Internet Explorer critical alert remains, because of a labeling error in Nessus which labels a legacy registry key file in Edge as a critical vulnerability. All other critical vulnerabilities have been     remediated.
   
   ![Vulnerability scanning20](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/02a7a686-b5c2-42b6-9b7b-1d72138b96cd)

3. Review the scan results as demonstrated above to confirm successful remediation.
   - Windows updates have all been executed successfully
   - Firefox outdated version has been uninstalled and upgraded to the most current version available
   - Snipping tool has been uninstalled
   - Microsoft Office 365 has been updated to the most current version available
   - Edge has been updated to the most current version possible

   ![Vulnerability scanning21](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/cb31bedb-5976-4f94-8873-6549d82ee5cb)

   ![Vulnerability scanning22](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/4bfb2455-21fb-49de-8e08-dd248420ebc0)

   ![Vulnerability scanning19](https://github.com/JoeyKenobi/Vulnerability-Scanning-Homelab-with-Nessus/assets/61059812/7b120e8c-6d27-48f8-808d-e4f52cf61c71)
